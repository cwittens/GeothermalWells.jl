var documenterSearchIndex = {"docs":
[{"location":"#GeothermalWells","page":"Home","title":"GeothermalWells","text":"Documentation for GeothermalWells.\n\n","category":"section"},{"location":"#GeothermalWells.AbstractBorehole","page":"Home","title":"GeothermalWells.AbstractBorehole","text":"Abstract base type for borehole geometries.\n\n\n\n\n\n","category":"type"},{"location":"#GeothermalWells.AbstractInletModel","page":"Home","title":"GeothermalWells.AbstractInletModel","text":"Abstract base type for inlet temperature models.\n\n\n\n\n\n","category":"type"},{"location":"#GeothermalWells.AbstractMaterialProperties","page":"Home","title":"GeothermalWells.AbstractMaterialProperties","text":"Abstract base type for material property models.\n\n\n\n\n\n","category":"type"},{"location":"#GeothermalWells.Borehole","page":"Home","title":"GeothermalWells.Borehole","text":"Borehole{T}(xc, yc, h, r_inner, t_inner, r_outer, t_outer, r_backfill, ṁ, insulation_depth)\n\nU-shaped coaxial borehole heat exchanger geometry.\n\nFluid flows down the inner pipe, turns around at depth h, and returns up the outer annulus. Precomputes squared radii and fluid velocities for performance.\n\nFields\n\nxc, yc: horizontal center coordinates [m]\nh: borehole depth [m]\nr_inner: inner pipe radius [m]\nt_inner: inner pipe wall thickness [m]\nr_outer: outer pipe inner radius [m]\nt_outer: outer pipe wall thickness [m]\nr_backfill: cement backfill outer radius [m]\nṁ: mass flow rate [kg/s]\ninsulation_depth: depth to which inner pipe is insulated [m]\n\n\n\n\n\n","category":"type"},{"location":"#GeothermalWells.ConstantInlet","page":"Home","title":"GeothermalWells.ConstantInlet","text":"ConstantInlet{T}(T_const)\n\nInlet model with constant temperature.\n\n\n\n\n\n","category":"type"},{"location":"#GeothermalWells.CustomInlet","page":"Home","title":"GeothermalWells.CustomInlet","text":"CustomInlet{F}(func)\n\nInlet model with custom function func(bh_idx, T_outlet_values, t).\n\nAllows arbitrary time-varying or borehole-specific inlet temperatures.\n\n\n\n\n\n","category":"type"},{"location":"#GeothermalWells.HeatExchangerInlet","page":"Home","title":"GeothermalWells.HeatExchangerInlet","text":"HeatExchangerInlet{T}(ΔT)\n\nInlet model applying temperature change ΔT [K] to outlet temperature.\n\nModels a heat exchanger where inlet is T_outlet - ΔT. Typically computed as ΔT = Q / (ṁ * c_water) where Q [W] is heat extraction rate, ṁ [kg/s] is mass flow rate, and c_water [J/(kg·K)] is specific heat.\n\n\n\n\n\n","category":"type"},{"location":"#GeothermalWells.HomogenousMaterialProperties","page":"Home","title":"GeothermalWells.HomogenousMaterialProperties","text":"HomogenousMaterialProperties{T}\n\nThermal properties with uniform rock properties (no stratification).\n\nSimpler alternative to StratifiedMaterialProperties when rock is homogeneous.\n\n\n\n\n\n","category":"type"},{"location":"#GeothermalWells.StratifiedMaterialProperties","page":"Home","title":"GeothermalWells.StratifiedMaterialProperties","text":"StratifiedMaterialProperties{N,T}\n\nThermal properties for stratified rock layers and borehole materials.\n\nSupports N horizontal rock layers with varying properties by depth. Includes material properties for water, steel, insulation, and cement backfill.\n\nFields\n\nk_rock_layers: thermal conductivities for each rock layer [W/(m·K)]\nrho_c_rock_layers: volumetric heat capacities for each layer [J/(m³·K)]\nlayer_depths: depth boundaries for each layer [m]\nk_water, rho_c_water: water thermal properties\nk_steel, rho_c_steel: steel pipe thermal properties\nk_insulating, rho_c_insulating: insulation thermal properties\nk_backfill, rho_c_backfill: cement backfill thermal properties\n\n\n\n\n\n","category":"type"},{"location":"#GeothermalWells.ADI_and_ADV_callback!-Tuple{Any}","page":"Home","title":"GeothermalWells.ADI_and_ADV_callback!","text":"ADI_and_ADV_callback!(integrator)\n\nAlternating Direction Implicit (ADI) callback for horizontal (x,y) diffusion combined with advection.\n\nThis callback implements operator splitting for the horizontal diffusion using the ADI scheme, interleaved with semi-Lagrangian advection. Each full timestep Δt is split into  two half-steps with alternating implicit directions:\n\nFirst half-step (Δt/2):\n\nExplicit y-diffusion: temp = (I + Δt/2 · Aᵧ) · ϕ\nAdvection applied to temp\nImplicit x-solve: (I - Δt/2 · Aₓ) · ϕ = temp\n\nSecond half-step (Δt/2):\n\nExplicit x-diffusion: temp = (I + Δt/2 · Aₓ) · ϕ\nAdvection applied to temp\nImplicit y-solve: (I - Δt/2 · Aᵧ) · ϕ = temp\n\nThe advection is placed after the explicit diffusion step and before the implicit Thomas solve.  Empirically, this is the only placement that avoids numerical instabilities. The suspected reason  is that advection introduces large thermal gradients, and applying it before an explicit Euler-like  step causes instability, whereas the subsequent implicit solve can handle these gradients stably.  However, the exact theoretical justification remains uncertain.\n\nVertical (z) diffusion is handled separately by the main ODE right-hand side (rhs_diffusion_z!)  because the ADI scheme is only unconditionally stable in 2D. However, since Δz is much larger  than the smallest Δx and Δy (due to the fine grid resolution needed near the borehole), an  explicit stabilized method (ROCK2) is sufficient for the z-direction without imposing  prohibitive time step restrictions.\n\nThe implicit x/y solves use the Thomas algorithm for the resulting tridiagonal systems.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.advection!-NTuple{5, Any}","page":"Home","title":"GeothermalWells.advection!","text":"advection!(ϕ, dt, t, cache, boreholes)\n\nApply advective heat transport in the borehole pipes using a semi-Lagrangian method.\n\nThe water flow itself is not simulated—instead, the fluid is assumed to move at prescribed  constant velocities: v_inner (downward in the inner pipe) and v_outer (upward in the  outer annulus). Only the temperature field is advected according to these fixed velocity profiles.\n\nA semi-Lagrangian approach is used rather than standard explicit advection schemes because  the high fluid velocities would impose prohibitively small time steps under the CFL constraint.  The semi-Lagrangian method traces characteristic lines backward in time to find the departure  point, then interpolates the temperature there using linear interpolation between grid points. At the turnaround point at the bottom of the borehole (depth h), where water transitions  from the inner pipe to the outer annulus, perfect mixing of temperature is assumed.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.compute_domain-Tuple{Any}","page":"Home","title":"GeothermalWells.compute_domain","text":"compute_domain(boreholes; buffer_x=100, buffer_y=100, buffer_z=200)\n\nCompute simulation domain bounds from borehole positions.\n\nReturns (xmin, xmax, ymin, ymax, zmin, zmax) encompassing all boreholes with specified buffers [m].\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.create_adaptive_grid_1d-Tuple{}","page":"Home","title":"GeothermalWells.create_adaptive_grid_1d","text":"create_adaptive_grid_1d(; xmin, xmax, dx_fine, growth_factor, dx_max, boreholes, backend, Float_used, direction)\n\nGenerate a non-uniform 1D grid with refined spacing around one or multiple boreholes.\n\nCreates a 1D grid along the specified direction with fine resolution near boreholes and geometrically increasing spacing away from them, up to a maximum cell size. Works for both single borehole and multi-borehole configurations.\n\nArguments\n\nxmin, xmax: Domain boundaries [m]\ndx_fine: Fine grid spacing near boreholes [m]\ngrowth_factor: Geometric growth rate for coarsening (e.g., 1.3)\ndx_max: Maximum grid spacing [m]\nboreholes: Single borehole or collection of borehole objects with positions and radii\nbackend: Computation backend (CPU/GPU) for array adaptation\nFloat_used: Floating point type for grid values\ndirection: Grid direction, either :x or :y\n\nGrid generation strategy\n\nFor single or multiple boreholes:\n\nCreates fine uniform grids around each borehole (spacing ≈ dx_fine)\nExtends from domain boundaries toward boreholes with geometric growth\nFor multiple boreholes: fills gaps between boreholes symmetrically with progressive coarsening\nEnsures all grid points are unique and sorted\n\nReturns\n\nBackend-adapted 1D grid array of the specified floating point type.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.create_advection_index_lists-NTuple{5, Any}","page":"Home","title":"GeothermalWells.create_advection_index_lists","text":"create_advection_index_lists(backend, gridx, gridy, gridz, boreholes)\n\nCreate index lists for advection in inner and outer pipes.\n\nReturns tuple with index lists for efficient advection kernel dispatch.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.create_cache-Tuple{}","page":"Home","title":"GeothermalWells.create_cache","text":"create_cache(; backend, gridx, gridy, gridz, materials, boreholes, inlet_model)\n\nCreate simulation cache with precomputed data and temporary arrays.\n\nReturns named tuple containing grids, materials, index lists, outlet temperature arrays, eigenvalue estimates, and precomputed Val types for kernel dispatch.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.create_uniform_gridz_with_borehole_depths-NTuple{5, Any}","page":"Home","title":"GeothermalWells.create_uniform_gridz_with_borehole_depths","text":"create_uniform_gridz_with_borehole_depths(zmin, zmax, dz, boreholes, backend)\n\nCreate vertical grid including all borehole depths.\n\nEnsures each borehole depth h is a grid point for accurate advection interpolation.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.data_brown_single_well_b-Tuple{}","page":"Home","title":"GeothermalWells.data_brown_single_well_b","text":"data_brown_single_well_b() -> (z_beier, T_beier), (z_brown, T_brown)\n\nLoad Brown et al. single well validation data (Figure 4b).\n\nFrom: Investigating scalability of deep borehole heat exchangers (doi:10.1016/j.renene.2021.01.036) Returns depth [m] and temperature [°C] profiles for Beier and Brown models.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.data_brown_single_well_c-Tuple{Any}","page":"Home","title":"GeothermalWells.data_brown_single_well_c","text":"data_brown_single_well_c(i) -> x_data, T_data\n\nLoad Brown et al. single well validation data (Figure 4c).\n\ni=1,2,3 for 300m, 600m, 920m depths respectively. From: doi:10.1016/j.renene.2021.01.036\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.data_dir-Tuple{}","page":"Home","title":"GeothermalWells.data_dir","text":"data_dir()\n\nReturn path to package data directory.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.data_hu-Tuple{Int64}","page":"Home","title":"GeothermalWells.data_hu","text":"data_hu(years::Int) -> depth, temperature\n\nLoad Hu et al. validation data for specified simulation years (Figure 7).\n\nFrom: Numerical modeling of a coaxial borehole heat exchanger (doi:10.1016/j.renene.2019.09.141) Returns depth [m] and temperature [°C].\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.data_li-Tuple{Any}","page":"Home","title":"GeothermalWells.data_li","text":"data_li(i) -> x_data, T_data\n\nLoad Li et al. validation data (Figure 5).\n\ni=1,2,3,4 for 500m, 1000m, 1500m, 2000m depths respectively. From: Heat extraction model and characteristics of coaxial deep borehole heat exchanger\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.eigen_estimator-Tuple{Any}","page":"Home","title":"GeothermalWells.eigen_estimator","text":"eigen_estimator(integrator)\n\nEigenvalue estimator function for adaptive time stepping in ROCK methods.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.eigen_estimator_get_dmax-Union{Tuple{StratifiedMaterialProperties{N}}, Tuple{N}} where N","page":"Home","title":"GeothermalWells.eigen_estimator_get_dmax","text":"eigen_estimator_get_dmax(materials) -> d_max\n\nCompute maximum thermal diffusivity [m²/s] across all materials.\n\nUsed for eigenvalue estimation in time stepping stability analysis.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.eigen_estimator_pre_calculation-Tuple{Any, Any}","page":"Home","title":"GeothermalWells.eigen_estimator_pre_calculation","text":"eigen_estimator_pre_calculation(gridz, materials) -> λ_max\n\nPre-calculate eigenvalue estimate [s⁻¹] for ROCK2/ROCK4 time stepping.\n\nEstimates maximum eigenvalue based on finest grid spacing and maximum diffusivity. Returns λ_max ≈ 8 * d_max / Δ_min² where conservative factor of 8 accounts for 3D diffusion operator.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.examples_dir-Tuple{}","page":"Home","title":"GeothermalWells.examples_dir","text":"examples_dir()\n\nReturn path to package examples directory.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.get_callback-Tuple{}","page":"Home","title":"GeothermalWells.get_callback","text":"get_callback(; saveat, print_every_n=1000, write_to_jld=false, data_folder_dir=\"\")\n\nCreate combined callback set for simulation.\n\nIncludes ADI+advection callback, progress printing, and solution saving. Returns (callback, saved_values).\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.get_rock_thermal_conductivity_by_depth-Union{Tuple{N}, Tuple{Any, StratifiedMaterialProperties{N}}} where N","page":"Home","title":"GeothermalWells.get_rock_thermal_conductivity_by_depth","text":"get_rock_thermal_conductivity_by_depth(z, materials::StratifiedMaterialProperties) -> k\n\nReturn rock thermal conductivity [W/(m·K)] at depth z based on stratified layers.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.get_rock_volumetric_heat_capacity_by_depth-Union{Tuple{N}, Tuple{Any, StratifiedMaterialProperties{N}}} where N","page":"Home","title":"GeothermalWells.get_rock_volumetric_heat_capacity_by_depth","text":"get_rock_volumetric_heat_capacity_by_depth(z, materials::StratifiedMaterialProperties) -> ρc\n\nReturn rock volumetric heat capacity [J/(m³·K)] at depth z based on stratified layers.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.get_thermal_conductivity-NTuple{5, Any}","page":"Home","title":"GeothermalWells.get_thermal_conductivity","text":"get_thermal_conductivity(x, y, z, boreholes, materials) -> k\n\nReturn thermal conductivity [W/(m·K)] at point (x, y, z).\n\nDetermines the appropriate material (rock, water, steel, insulation, or backfill) based on position relative to borehole geometry.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.get_volumetric_heat_capacity-NTuple{5, Any}","page":"Home","title":"GeothermalWells.get_volumetric_heat_capacity","text":"get_volumetric_heat_capacity(x, y, z, boreholes, materials) -> ρc\n\nReturn volumetric heat capacity [J/(m³·K)] at point (x, y, z).\n\nDetermines the appropriate material based on position relative to borehole geometry.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.initial_condition_thermal_gradient-NTuple{5, Any}","page":"Home","title":"GeothermalWells.initial_condition_thermal_gradient","text":"initial_condition_thermal_gradient(backend, Float_used, gridx, gridy, gridz; T_surface, gradient)\n\nCreate initial temperature field with linear thermal gradient.\n\nReturns 3D array with T(z) = T_surface + gradient * z where T_surface is surface temperature [°C] and gradient is thermal gradient [K/m or °C/m].\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.pkg_dir-Tuple{}","page":"Home","title":"GeothermalWells.pkg_dir","text":"pkg_dir()\n\nReturn package root directory.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.rhs_diffusion_z!-NTuple{4, Any}","page":"Home","title":"GeothermalWells.rhs_diffusion_z!","text":"rhs_diffusion_z!(dϕ, ϕ, cache, t)\n\nCompute right-hand side for vertical (z-direction) heat diffusion.\n\nThis is the RHS function passed to OrdinaryDiffEq.jl and is integrated using an explicit  stabilized ROCK method. Vertical diffusion is treated separately from horizontal (x,y) diffusion  because the ADI scheme is only unconditionally stable in 2D. Since Δz is much larger than the  smallest Δx and Δy (due to the fine grid resolution needed near the borehole), the explicit  ROCK method is sufficient for the z-direction without imposing prohibitive time step restrictions.\n\nHorizontal diffusion via the ADI method and advection are handled separately using the callback  functionality (ADI_and_ADV_callback!)—a workaround to implement operator splitting within the  OrdinaryDiffEq.jl framework.\n\n\n\n\n\n","category":"method"},{"location":"#GeothermalWells.save_and_print_callback-Tuple{Any}","page":"Home","title":"GeothermalWells.save_and_print_callback","text":"save_and_print_callback(saveat; print_every_n=1000, write_to_jld=false, data_folder_dir=\"\")\n\nCreate callbacks for printing progress and saving solution snapshots.\n\nReturns (save_cb, print_cb, saved_values) for use with ODE solver. Optionally writes checkpoints to JLD2 files if write_to_jld=true.\n\n\n\n\n\n","category":"method"}]
}
