var documenterSearchIndex = {"docs":
[{"location":"changelog_tmp/#Changelog","page":"Changelog","title":"Changelog","text":"GeothermalWells.jl follows semantic versioning.","category":"section"},{"location":"changelog_tmp/#Unreleased","page":"Changelog","title":"Unreleased","text":"","category":"section"},{"location":"changelog_tmp/#v0.1.3","page":"Changelog","title":"v0.1.3","text":"","category":"section"},{"location":"changelog_tmp/#Added","page":"Changelog","title":"Added","text":"Logo and favicon to documentation","category":"section"},{"location":"changelog_tmp/#Changed","page":"Changelog","title":"Changed","text":"Added validation error when write_to_jld=true but data_folder_dir is empty","category":"section"},{"location":"changelog_tmp/#v0.1.2","page":"Changelog","title":"v0.1.2","text":"","category":"section"},{"location":"changelog_tmp/#Added-2","page":"Changelog","title":"Added","text":"Documentation (#4)","category":"section"},{"location":"changelog_tmp/#Changed-2","page":"Changelog","title":"Changed","text":"Renamed get_callback to get_simulation_callback to clarify that it is required and not optional (#4)\n\n","category":"section"},{"location":"changelog_tmp/#v0.1.1","page":"Changelog","title":"v0.1.1","text":"","category":"section"},{"location":"changelog_tmp/#Added-3","page":"Changelog","title":"Added","text":"Released as an official Julia package in the General registry","category":"section"},{"location":"changelog_tmp/#Fixed","page":"Changelog","title":"Fixed","text":"Bug in print_every_n parameter handling in the callback\n\n","category":"section"},{"location":"changelog_tmp/#v0.1.0","page":"Changelog","title":"v0.1.0","text":"","category":"section"},{"location":"changelog_tmp/#Added-4","page":"Changelog","title":"Added","text":"Initial release with core functionality\nCoaxial borehole heat exchanger simulation\nAdaptive grid generation\nGPU support via KernelAbstractions.jl\nIntegration with OrdinaryDiffEq.jl solvers","category":"section"},{"location":"license/#license-page","page":"License","title":"License","text":"GeothermalWells.jl is licensed under the MIT License:\n\nMIT License\n\nCopyright (c) 2026 Collin Wittenstein <collin.wittenstein@gmail.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.","category":"section"},{"location":"getting_started/#getting-started","page":"Getting Started","title":"Getting Started","text":"This guide walks through a complete simulation of a single deep borehole heat exchanger.","category":"section"},{"location":"getting_started/#Overview","page":"Getting Started","title":"Overview","text":"A typical GeothermalWells.jl simulation involves:\n\nDefining material properties (rock, water, steel, etc.)\nSpecifying borehole geometry\nCreating computational grids\nSetting initial conditions\nChoosing an inlet model\nRunning the simulation","category":"section"},{"location":"getting_started/#Complete-Example","page":"Getting Started","title":"Complete Example","text":"using GeothermalWells\nusing OrdinaryDiffEqStabilizedRK: ODEProblem, solve, ROCK2\nusing KernelAbstractions: CPU\n\n# Choose backend: CPU() for testing, CUDABackend() for NVIDIA GPU\nbackend = CPU()\nFloat_used = Float64\n\nwarning: Use Float64\nUsing Float32 can cause numerical instabilities in some cases. It is recommended to use Float64 for reliable results.","category":"section"},{"location":"getting_started/#Material-Properties","page":"Getting Started","title":"Material Properties","text":"Define thermal properties for all materials in the simulation:\n\nmaterials = HomogenousMaterialProperties{Float_used}(\n    2.88,       # k_rock - rock thermal conductivity [W/(m·K)]\n    2.17e6,     # rho_c_rock - rock volumetric heat capacity [J/(m³·K)]\n    0.6,        # k_water [W/(m·K)]\n    4.18e6,     # rho_c_water [J/(m³·K)]\n    44.5,       # k_steel [W/(m·K)]\n    3.73e6,     # rho_c_steel [J/(m³·K)]\n    0.26,       # k_insulating [W/(m·K)]\n    1.96e6,     # rho_c_insulating [J/(m³·K)]\n    1.0,        # k_backfill [W/(m·K)]\n    1.0         # rho_c_backfill [J/(m³·K)]\n)\n\nFor layered rock formations, use StratifiedMaterialProperties instead.","category":"section"},{"location":"getting_started/#Borehole-Geometry","page":"Getting Started","title":"Borehole Geometry","text":"Define the coaxial borehole heat exchanger geometry:\n\nborehole = Borehole{Float_used}(\n    0.0,             # xc - x-coordinate of center [m]\n    0.0,             # yc - y-coordinate of center [m]\n    2000.0,          # h - borehole depth [m]\n    0.0381,          # r_inner - inner pipe radius [m]\n    0.01,            # t_inner - inner pipe wall thickness [m]\n    0.0889,          # r_outer - outer pipe inner radius [m]\n    0.01,            # t_outer - outer pipe wall thickness [m]\n    0.0989,          # r_backfill - backfill outer radius [m]\n    10.0,            # ṁ - mass flow rate [kg/s]\n    500.0            # insulation_depth - depth of inner pipe insulation [m]\n)\n\nboreholes = (borehole,)  # tuple of all boreholes","category":"section"},{"location":"getting_started/#Grid-Setup","page":"Getting Started","title":"Grid Setup","text":"Create adaptive grids that are fine near the borehole and coarse far away:\n\n# Domain boundaries\nxmin, xmax = -100.0, 100.0\nymin, ymax = -100.0, 100.0\nzmin, zmax = 0.0, 2200.0\n\n# Grid parameters\ndx_fine = 0.0025      # fine spacing near borehole [m]\ngrowth_factor = 1.3   # geometric growth rate\ndx_max = 10.0         # maximum spacing far from borehole [m]\ndz = 100.0            # vertical spacing [m]\n\ngridx = create_adaptive_grid_1d(\n    xmin=xmin, xmax=xmax,\n    dx_fine=dx_fine, growth_factor=growth_factor, dx_max=dx_max,\n    boreholes=boreholes, backend=backend, Float_used=Float_used, direction=:x\n)\n\ngridy = create_adaptive_grid_1d(\n    xmin=ymin, xmax=ymax,\n    dx_fine=dx_fine, growth_factor=growth_factor, dx_max=dx_max,\n    boreholes=boreholes, backend=backend, Float_used=Float_used, direction=:y\n)\n\ngridz = create_uniform_gridz_with_borehole_depths(\n    zmin=zmin, zmax=zmax, dz=dz,\n    boreholes=boreholes, backend=backend\n)\n\nprintln(\"Grid size: $(length(gridx)) x $(length(gridy)) x $(length(gridz))\")","category":"section"},{"location":"getting_started/#Initial-Condition","page":"Getting Started","title":"Initial Condition","text":"Set the initial temperature field with a geothermal gradient:\n\nT0 = initial_condition_thermal_gradient(\n    backend, Float_used, gridx, gridy, gridz;\n    T_surface=10.0,    # surface temperature [°C]\n    gradient=0.03      # thermal gradient [K/m]\n)","category":"section"},{"location":"getting_started/#Inlet-Model","page":"Getting Started","title":"Inlet Model","text":"Choose how the inlet temperature is determined:\n\n# Option 1: Constant inlet temperature\ninlet_model = ConstantInlet{Float_used}(20.0)  # 20°C\n\n# Option 2: Heat exchanger (inlet = outlet - ΔT)\n# inlet_model = HeatExchangerInlet{Float_used}(5.0)  # ΔT = 5K","category":"section"},{"location":"getting_started/#Create-Cache-and-Solve","page":"Getting Started","title":"Create Cache and Solve","text":"cache = create_cache(\n    backend=backend,\n    gridx=gridx,\n    gridy=gridy,\n    gridz=gridz,\n    materials=materials,\n    boreholes=boreholes,\n    inlet_model=inlet_model\n)\n\n# Time span: simulate for 1 day\ntspan = (0.0, 3600.0 * 24.0)\n\nprob = ODEProblem(rhs_diffusion_z!, T0, tspan, cache)\n\n# Callback handles ADI (horizontal diffusion) and advection, plus saves solutions\n# This is required - without it, only vertical diffusion is computed\ncallback, saved_values = get_simulation_callback(\n    saveat=range(tspan..., 10),  # times to save solutions\n    print_every_n=100            # print progress every N steps\n)\n\n# Solve with ROCK2 (stabilized explicit Runge-Kutta)\nΔt = 80.0  # time step [s]\n\nsolve(\n    prob,\n    ROCK2(max_stages=100, eigen_est=eigen_estimator),\n    save_everystep=false,\n    callback=callback,\n    adaptive=false,\n    dt=Δt,\n    maxiters=Int(1e10)\n)","category":"section"},{"location":"getting_started/#GPU-Acceleration","page":"Getting Started","title":"GPU Acceleration","text":"For GPU acceleration, simply change the backend:\n\nusing CUDA: CUDABackend\n\nbackend = CUDABackend()\n\n# All other code remains the same!","category":"section"},{"location":"getting_started/#Well-Arrays","page":"Getting Started","title":"Well Arrays","text":"To simulate multiple boreholes, create a tuple of Borehole objects:\n\n# 3x3 array with 30m spacing\nboreholes = tuple(\n    (Borehole{Float_used}(\n        xc, yc,          # center coordinates\n        2000.0,          # depth\n        # ... other parameters\n    ) for xc in [-30.0, 0.0, 30.0], yc in [-30.0, 0.0, 30.0])...\n)","category":"section"},{"location":"getting_started/#Next-Steps","page":"Getting Started","title":"Next Steps","text":"See the API Reference for detailed documentation\nCheck the examples/ folder:\nsingle_borehole_basic.jl - Single borehole simulation\nwell_array_basic.jl - Multi-well array simulation\nSee the reproducibility repository for advanced examples reproducing results from literature (Li et al. (2021), Hu et al. (2020), Brown et al. (2023))","category":"section"},{"location":"changelog/#Changelog","page":"Changelog","title":"Changelog","text":"GeothermalWells.jl follows semantic versioning.","category":"section"},{"location":"changelog/#Unreleased","page":"Changelog","title":"Unreleased","text":"","category":"section"},{"location":"changelog/#v0.1.3","page":"Changelog","title":"v0.1.3","text":"","category":"section"},{"location":"changelog/#Added","page":"Changelog","title":"Added","text":"Logo and favicon to documentation","category":"section"},{"location":"changelog/#Changed","page":"Changelog","title":"Changed","text":"Added validation error when write_to_jld=true but data_folder_dir is empty","category":"section"},{"location":"changelog/#v0.1.2","page":"Changelog","title":"v0.1.2","text":"","category":"section"},{"location":"changelog/#Added-2","page":"Changelog","title":"Added","text":"Documentation (#4)","category":"section"},{"location":"changelog/#Changed-2","page":"Changelog","title":"Changed","text":"Renamed get_callback to get_simulation_callback to clarify that it is required and not optional (#4)\n\n","category":"section"},{"location":"changelog/#v0.1.1","page":"Changelog","title":"v0.1.1","text":"","category":"section"},{"location":"changelog/#Added-3","page":"Changelog","title":"Added","text":"Released as an official Julia package in the General registry","category":"section"},{"location":"changelog/#Fixed","page":"Changelog","title":"Fixed","text":"Bug in print_every_n parameter handling in the callback\n\n","category":"section"},{"location":"changelog/#v0.1.0","page":"Changelog","title":"v0.1.0","text":"","category":"section"},{"location":"changelog/#Added-4","page":"Changelog","title":"Added","text":"Initial release with core functionality\nCoaxial borehole heat exchanger simulation\nAdaptive grid generation\nGPU support via KernelAbstractions.jl\nIntegration with OrdinaryDiffEq.jl solvers","category":"section"},{"location":"reference/#api-reference","page":"API Reference","title":"API Reference","text":"","category":"section"},{"location":"reference/#Material-Properties","page":"API Reference","title":"Material Properties","text":"","category":"section"},{"location":"reference/#Borehole-Geometry","page":"API Reference","title":"Borehole Geometry","text":"","category":"section"},{"location":"reference/#Inlet-Models","page":"API Reference","title":"Inlet Models","text":"","category":"section"},{"location":"reference/#Grid-Generation","page":"API Reference","title":"Grid Generation","text":"","category":"section"},{"location":"reference/#Initial-Conditions","page":"API Reference","title":"Initial Conditions","text":"","category":"section"},{"location":"reference/#Simulation","page":"API Reference","title":"Simulation","text":"","category":"section"},{"location":"reference/#Utilities","page":"API Reference","title":"Utilities","text":"","category":"section"},{"location":"reference/#Validation-Data","page":"API Reference","title":"Validation Data","text":"Functions for loading reference data from published studies:","category":"section"},{"location":"reference/#GeothermalWells.HomogenousMaterialProperties","page":"API Reference","title":"GeothermalWells.HomogenousMaterialProperties","text":"HomogenousMaterialProperties{T}\n\nThermal properties with uniform rock properties (no stratification).\n\nSimpler alternative to StratifiedMaterialProperties when rock is homogeneous.\n\n\n\n\n\n","category":"type"},{"location":"reference/#GeothermalWells.StratifiedMaterialProperties","page":"API Reference","title":"GeothermalWells.StratifiedMaterialProperties","text":"StratifiedMaterialProperties{N,T}\n\nThermal properties for stratified rock layers and borehole materials.\n\nSupports N horizontal rock layers with varying properties by depth. Includes material properties for water, steel, insulation, and cement backfill.\n\nFields\n\nk_rock_layers: thermal conductivities for each rock layer [W/(m·K)]\nrho_c_rock_layers: volumetric heat capacities for each layer [J/(m³·K)]\nlayer_depths: depth boundaries for each layer [m]\nk_water, rho_c_water: water thermal properties\nk_steel, rho_c_steel: steel pipe thermal properties\nk_insulating, rho_c_insulating: insulation thermal properties\nk_backfill, rho_c_backfill: cement backfill thermal properties\n\n\n\n\n\n","category":"type"},{"location":"reference/#GeothermalWells.Borehole","page":"API Reference","title":"GeothermalWells.Borehole","text":"Borehole{T}(xc, yc, h, r_inner, t_inner, r_outer, t_outer, r_backfill, ṁ, insulation_depth)\n\nU-shaped coaxial borehole heat exchanger geometry.\n\nFluid flows down the inner pipe, turns around at depth h, and returns up the outer annulus. Precomputes squared radii and fluid velocities for performance.\n\nFields\n\nxc, yc: horizontal center coordinates [m]\nh: borehole depth [m]\nr_inner: inner pipe radius [m]\nt_inner: inner pipe wall thickness [m]\nr_outer: outer pipe inner radius [m]\nt_outer: outer pipe wall thickness [m]\nr_backfill: cement backfill outer radius [m]\nṁ: mass flow rate [kg/s]\ninsulation_depth: depth to which inner pipe is insulated [m]\n\n\n\n\n\n","category":"type"},{"location":"reference/#GeothermalWells.ConstantInlet","page":"API Reference","title":"GeothermalWells.ConstantInlet","text":"ConstantInlet{T}(T_const)\n\nInlet model with constant temperature.\n\n\n\n\n\n","category":"type"},{"location":"reference/#GeothermalWells.HeatExchangerInlet","page":"API Reference","title":"GeothermalWells.HeatExchangerInlet","text":"HeatExchangerInlet{T}(ΔT)\n\nInlet model applying temperature change ΔT [K] to outlet temperature.\n\nModels a heat exchanger where inlet is T_outlet - ΔT. Typically computed as ΔT = Q / (ṁ * c_water) where Q [W] is heat extraction rate, ṁ [kg/s] is mass flow rate, and c_water [J/(kg·K)] is specific heat.\n\n\n\n\n\n","category":"type"},{"location":"reference/#GeothermalWells.CustomInlet","page":"API Reference","title":"GeothermalWells.CustomInlet","text":"CustomInlet{F}(func)\n\nInlet model with custom function func(bh_idx, T_outlet_values, t).\n\nAllows arbitrary time-varying or borehole-specific inlet temperatures.\n\n\n\n\n\n","category":"type"},{"location":"reference/#GeothermalWells.create_adaptive_grid_1d","page":"API Reference","title":"GeothermalWells.create_adaptive_grid_1d","text":"create_adaptive_grid_1d(; xmin, xmax, dx_fine, growth_factor, dx_max, boreholes, backend, Float_used, direction)\n\nGenerate a non-uniform 1D grid with refined spacing around one or multiple boreholes.\n\nCreates a 1D grid along the specified direction with fine resolution near boreholes and geometrically increasing spacing away from them, up to a maximum cell size. Works for both single borehole and multi-borehole configurations.\n\nArguments\n\nxmin, xmax: Domain boundaries [m]\ndx_fine: Fine grid spacing near boreholes [m]\ngrowth_factor: Geometric growth rate for coarsening (e.g., 1.3)\ndx_max: Maximum grid spacing [m]\nboreholes: Single borehole or collection of borehole objects with positions and radii\nbackend: Computation backend (CPU/GPU) for array adaptation\nFloat_used: Floating point type for grid values\ndirection: Grid direction, either :x or :y\n\nGrid generation strategy\n\nFor single or multiple boreholes:\n\nCreates fine uniform grids around each borehole (spacing ≈ dx_fine)\nExtends from domain boundaries toward boreholes with geometric growth\nFor multiple boreholes: fills gaps between boreholes symmetrically with progressive coarsening\nEnsures all grid points are unique and sorted\n\nReturns\n\nBackend-adapted 1D grid array of the specified floating point type.\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.create_uniform_gridz_with_borehole_depths","page":"API Reference","title":"GeothermalWells.create_uniform_gridz_with_borehole_depths","text":"create_uniform_gridz_with_borehole_depths(; zmin, zmax, dz, boreholes, backend)\n\nCreate vertical grid including all borehole depths.\n\nEnsures each borehole depth h is a grid point for accurate advection interpolation.\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.compute_domain","page":"API Reference","title":"GeothermalWells.compute_domain","text":"compute_domain(boreholes; buffer_x=100, buffer_y=100, buffer_z=200)\n\nCompute simulation domain bounds from borehole positions.\n\nReturns (xmin, xmax, ymin, ymax, zmin, zmax) encompassing all boreholes with specified buffers [m].\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.initial_condition_thermal_gradient","page":"API Reference","title":"GeothermalWells.initial_condition_thermal_gradient","text":"initial_condition_thermal_gradient(backend, Float_used, gridx, gridy, gridz; T_surface, gradient)\n\nCreate initial temperature field with linear thermal gradient.\n\nReturns 3D array with T(z) = T_surface + gradient * z where T_surface is surface temperature [°C] and gradient is thermal gradient [K/m or °C/m].\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.create_cache","page":"API Reference","title":"GeothermalWells.create_cache","text":"create_cache(; backend, gridx, gridy, gridz, materials, boreholes, inlet_model)\n\nCreate simulation cache with precomputed data and temporary arrays.\n\nReturns named tuple containing grids, materials, index lists, outlet temperature arrays, eigenvalue estimates, and precomputed Val types for kernel dispatch.\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.rhs_diffusion_z!","page":"API Reference","title":"GeothermalWells.rhs_diffusion_z!","text":"rhs_diffusion_z!(dϕ, ϕ, cache, t)\n\nCompute right-hand side for vertical (z-direction) heat diffusion.\n\nThis is the RHS function passed to OrdinaryDiffEq.jl and is integrated using an explicit  stabilized ROCK method. Vertical diffusion is treated separately from horizontal (x,y) diffusion  because the ADI scheme is only unconditionally stable in 2D. Since Δz is much larger than the  smallest Δx and Δy (due to the fine grid resolution needed near the borehole), the explicit  ROCK method is sufficient for the z-direction without imposing prohibitive time step restrictions.\n\nHorizontal diffusion via the ADI method and advection are handled separately using the callback  functionality (ADI_and_ADV_callback!)—a workaround to implement operator splitting within the  OrdinaryDiffEq.jl framework.\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.eigen_estimator","page":"API Reference","title":"GeothermalWells.eigen_estimator","text":"eigen_estimator(integrator)\n\nEigenvalue estimator function for adaptive time stepping in ROCK methods.\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.get_simulation_callback","page":"API Reference","title":"GeothermalWells.get_simulation_callback","text":"get_simulation_callback(; saveat, print_every_n=1000, write_to_jld=false, data_folder_dir=\"\")\n\nCreate the required callback set for the simulation.\n\nwarning: Required\nThis callback is essential for the simulation. It performs the ADI (Alternating Direction Implicit) method for horizontal diffusion and the semi-Lagrangian advection. Without this callback, only vertical diffusion (handled by ROCK2) is computed.\n\nThe callback combines three components:\n\nADI + Advection: Horizontal diffusion and fluid advection (runs every timestep)\nProgress printing: Prints simulation progress every print_every_n steps\nSolution saving: Saves temperature field at times specified by saveat\n\nArguments\n\nsaveat: Times at which to save the solution (e.g., range(0, 3600, 10) or [0.0, 3600.0])\nprint_every_n=1000: Print progress every N accepted timesteps\nwrite_to_jld=false: If true, also write checkpoints to JLD2 files\ndata_folder_dir=\"\": Directory for JLD2 checkpoint files (required if write_to_jld=true)\n\nReturns\n\ncallback: Combined CallbackSet to pass to solve(..., callback=callback)\nsaved_values: SavedValues object containing saved solutions accessible via saved_values.saveval\n\nExample\n\ncallback, saved_values = get_simulation_callback(\n    saveat=[0.0, 3600.0, 7200.0],\n    print_every_n=100\n)\nsolve(prob, ROCK2(eigen_est=eigen_estimator), callback=callback, dt=80.0, adaptive=false)\n\n# Access saved solutions\nT_final = saved_values.saveval[end]\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.pkg_dir","page":"API Reference","title":"GeothermalWells.pkg_dir","text":"pkg_dir()\n\nReturn package root directory.\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.examples_dir","page":"API Reference","title":"GeothermalWells.examples_dir","text":"examples_dir()\n\nReturn path to package examples directory.\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.data_dir","page":"API Reference","title":"GeothermalWells.data_dir","text":"data_dir()\n\nReturn path to package data directory.\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.plot_grid","page":"API Reference","title":"GeothermalWells.plot_grid","text":"plot_grid(gridx, gridy; boreholes=nothing, xlims=nothing, ylims=nothing, ...)\n\nVisualize the computational grid in the x-y plane.\n\nPlots grid lines and optionally overlays borehole geometry (inner pipe, outer pipe, backfill boundaries). Useful for verifying grid resolution near boreholes.\n\nArguments\n\ngridx: Grid coordinates in x-direction\ngridy: Grid coordinates in y-direction\nboreholes=nothing: Tuple of Borehole objects to overlay\nxlims=nothing: x-axis limits (auto-determined if not provided)\nylims=nothing: y-axis limits (auto-determined if not provided)\nsize=(800, 800): Figure size in pixels\nannotate=true: Add text labels to borehole components\nlegend=:bottomleft: Legend position\n\nReturns\n\nA Plots.jl plot object.\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.data_li","page":"API Reference","title":"GeothermalWells.data_li","text":"data_li(i) -> x_data, T_data\n\nLoad Li et al. validation data (Figure 5).\n\ni=1,2,3,4 for 500m, 1000m, 1500m, 2000m depths respectively. From: Heat extraction model and characteristics of coaxial deep borehole heat exchanger\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.data_hu","page":"API Reference","title":"GeothermalWells.data_hu","text":"data_hu(years::Int) -> depth, temperature\n\nLoad Hu et al. validation data for specified simulation years (Figure 7).\n\nFrom: Numerical modeling of a coaxial borehole heat exchanger (doi:10.1016/j.renene.2019.09.141) Returns depth [m] and temperature [°C].\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.data_brown_single_well_b","page":"API Reference","title":"GeothermalWells.data_brown_single_well_b","text":"data_brown_single_well_b() -> (z_beier, T_beier), (z_brown, T_brown)\n\nLoad Brown et al. single well validation data (Figure 4b).\n\nFrom: Investigating scalability of deep borehole heat exchangers (doi:10.1016/j.renene.2021.01.036) Returns depth [m] and temperature [°C] profiles for Beier and Brown models.\n\n\n\n\n\n","category":"function"},{"location":"reference/#GeothermalWells.data_brown_single_well_c","page":"API Reference","title":"GeothermalWells.data_brown_single_well_c","text":"data_brown_single_well_c(i) -> x_data, T_data\n\nLoad Brown et al. single well validation data (Figure 4c).\n\ni=1,2,3 for 300m, 600m, 920m depths respectively. From: doi:10.1016/j.renene.2021.01.036\n\n\n\n\n\n","category":"function"},{"location":"#GeothermalWells.jl","page":"Home","title":"GeothermalWells.jl","text":"<p align=\"center\">\n  <img height=\"200px\" alt=\"logo\" src=\"assets/geothermalwells_banner.svg\">\n</p>\n\n(Image: Docs-stable) (Image: Docs-dev) (Image: Julia) (Image: Build Status) (Image: Coverage) (Image: License: MIT)\n\nGeothermalWells.jl is a Julia package for simulating deep borehole heat exchangers (DBHEs), supporting both single wells and well arrays. The package is designed to be easy to use, enabling rapid prototyping and well design exploration, while providing GPU-accelerated performance for long-term simulations.\n\nnote: Under Development\nThis package is currently under active development and there may be breaking changes.","category":"section"},{"location":"#Features","page":"Home","title":"Features","text":"Full 3D simulation of coaxial deep borehole heat exchangers\nSupport for single wells and multi-well arrays\nGPU acceleration via KernelAbstractions.jl (CUDA, AMD ROCm)\nAdaptive grid generation with fine resolution near boreholes\nIntegration with OrdinaryDiffEq.jl solvers","category":"section"},{"location":"#Installation","page":"Home","title":"Installation","text":"GeothermalWells.jl works with Julia v1.12 and newer. Install it from the Julia REPL:\n\njulia> using Pkg\njulia> Pkg.add(\"GeothermalWells\")\n\nFor GPU support, also install the appropriate backend:\n\njulia> Pkg.add(\"CUDA\")        # for NVIDIA GPUs\njulia> Pkg.add(\"AMDGPU\")      # for AMD GPUs","category":"section"},{"location":"#Quick-Example","page":"Home","title":"Quick Example","text":"using GeothermalWells\nusing OrdinaryDiffEqStabilizedRK: ODEProblem, solve, ROCK2\nusing KernelAbstractions: CPU\n\n# Define material properties\nmaterials = HomogenousMaterialProperties{Float64}(\n    2.88,    # k_rock [W/(m·K)]\n    2.17e6,  # rho_c_rock [J/(m³·K)]\n    0.6,     # k_water [W/(m·K)]\n    4.18e6,  # rho_c_water [J/(m³·K)]\n    44.5,    # k_steel [W/(m·K)]\n    3.73e6,  # rho_c_steel [J/(m³·K)]\n    0.26,    # k_insulating [W/(m·K)]\n    1.96e6,  # rho_c_insulating [J/(m³·K)]\n    1.0,     # k_backfill [W/(m·K)]\n    1.0      # rho_c_backfill [J/(m³·K)]\n)\n\n# Define borehole geometry\nborehole = Borehole{Float64}(\n    0.0, 0.0,    # center position (x, y) [m]\n    2000.0,      # depth [m]\n    0.0381,      # inner pipe radius [m]\n    0.01,        # inner pipe thickness [m]\n    0.0889,      # outer pipe radius [m]\n    0.01,        # outer pipe thickness [m]\n    0.0989,      # backfill radius [m]\n    10.0,        # mass flow rate [kg/s]\n    500.0        # insulation depth [m]\n)\n\n# Create grids\ngridx = create_adaptive_grid_1d(xmin=-100.0, xmax=100.0, dx_fine=0.0025,\n    growth_factor=1.3, dx_max=10.0, boreholes=(borehole,),\n    backend=CPU(), Float_used=Float64, direction=:x)\ngridy = create_adaptive_grid_1d(xmin=-100.0, xmax=100.0, dx_fine=0.0025,\n    growth_factor=1.3, dx_max=10.0, boreholes=(borehole,),\n    backend=CPU(), Float_used=Float64, direction=:y)\ngridz = create_uniform_gridz_with_borehole_depths(zmin=0.0, zmax=2200.0,\n    dz=100.0, boreholes=(borehole,), backend=CPU())\n\n# Initial temperature with geothermal gradient\nT0 = initial_condition_thermal_gradient(CPU(), Float64, gridx, gridy, gridz;\n    T_surface=10.0, gradient=0.03)\n\n# Create cache and solve\ncache = create_cache(backend=CPU(), gridx=gridx, gridy=gridy, gridz=gridz,\n    materials=materials, boreholes=(borehole,),\n    inlet_model=ConstantInlet{Float64}(20.0))\n\ncallback, saved_values = get_simulation_callback(saveat=[0.0, 3600.0])\n\nprob = ODEProblem(rhs_diffusion_z!, T0, (0.0, 3600.0), cache)\nsolve(prob, ROCK2(eigen_est=eigen_estimator), dt=60.0, callback=callback, adaptive=false)\n\nSee the Getting Started guide for a complete walkthrough.","category":"section"},{"location":"#Examples-and-Reproducibility","page":"Home","title":"Examples and Reproducibility","text":"For more comprehensive examples, including validation against published literature, see the reproducibility repository. This repository contains:\n\nReproduction of results from Li et al. (2021), Hu et al. (2020), Brown et al. (2023)\nConvergence studies\nWell array simulations","category":"section"},{"location":"#Referencing","page":"Home","title":"Referencing","text":"If you use GeothermalWells.jl in your research, please cite it:\n\n@software{wittenstein2026geothermalwells,\n  title={{GeothermalWells.jl}: {GPU}-accelerated simulation of deep borehole heat exchanger (DBHE) arrays},\n  author={Wittenstein, Collin},\n  year={2026},\n  howpublished={\\url{https://github.com/cwittens/GeothermalWells.jl}},\n  doi = {10.5281/zenodo.18405325}\n}","category":"section"},{"location":"#Authors","page":"Home","title":"Authors","text":"Collin Wittenstein (Massachusetts Institute of Technology & Johannes Gutenberg University Mainz)","category":"section"},{"location":"#License","page":"Home","title":"License","text":"GeothermalWells.jl is licensed under the MIT license (see License).","category":"section"},{"location":"methodology/#methodology","page":"Methodology","title":"Methodology","text":"This page provides a brief overview of the numerical methods used in GeothermalWells.jl. For full details, see the accompanying paper (TODO: add link when published).","category":"section"},{"location":"methodology/#Governing-Equation","page":"Methodology","title":"Governing Equation","text":"GeothermalWells.jl solves the three-dimensional advection-diffusion equation for temperature T(xyzt):\n\nrho c fracpartial Tpartial t = nabla cdot (k nabla T) - rho c  v_z fracpartial Tpartial z\n\nwhere:\n\nrho c(xyz) is the volumetric heat capacity\nk(xyz) is the thermal conductivity\nv_z(xyz) is the vertical fluid velocity (non-zero only in the pipes)\n\nDiffusion occurs everywhere (rock, grout, pipes, fluid), while advection acts only within the borehole pipes where fluid flows.","category":"section"},{"location":"methodology/#Operator-Splitting","page":"Methodology","title":"Operator Splitting","text":"The equation is solved using operator splitting, separating the problem into three subproblems:\n\nOperator Method Why\nVertical diffusion ROCK2 (stabilized explicit Runge-Kutta-Chebyshev) Coarse vertical grid (Delta z sim meters) allows explicit treatment\nHorizontal diffusion ADI (Alternating Direction Implicit) Fine horizontal grid (Delta x Delta y sim mm) requires implicit treatment for stability\nAdvection Semi-Lagrangian Unconditionally stable for large time steps\n\nThis splitting is motivated by the strongly anisotropic grid: fine horizontal resolution is needed to resolve the borehole geometry, while coarser vertical resolution suffices.","category":"section"},{"location":"methodology/#Adaptive-Grid","page":"Methodology","title":"Adaptive Grid","text":"The computational grid uses adaptive spacing:\n\nFine resolution (sim 25 mm) near and inside boreholes to accurately resolve the geometry\nCoarse resolution (up to sim 10 m) far from boreholes where gradients are weaker\nGeometric growth between fine and coarse regions\n\nThis allows efficient simulation of the multi-scale problem (mm-scale pipes, 100m-scale thermal influence zone, km-scale depth).","category":"section"},{"location":"methodology/#Borehole-Model","page":"Methodology","title":"Borehole Model","text":"The coaxial borehole heat exchanger consists of:\n\nInner pipe: fluid flows upward (outlet)\nOuter annulus: fluid flows downward (inlet)\nPipe walls: steel with optional insulation on inner pipe\nBackfill/grout: between outer pipe and rock\nSurrounding rock: extends to domain boundaries\n\nAt the borehole bottom, perfect mixing is assumed: the temperature is averaged across the annulus and transferred to the inner pipe.","category":"section"},{"location":"methodology/#GPU-Acceleration","page":"Methodology","title":"GPU Acceleration","text":"GeothermalWells.jl uses KernelAbstractions.jl for vendor-agnostic GPU kernels, enabling:\n\nNVIDIA GPUs via CUDA.jl\nAMD GPUs via AMDGPU.jl\nCPU execution for testing and debugging\n\nThe same code runs on all backends - just change CPU() to CUDABackend().","category":"section"}]
}
