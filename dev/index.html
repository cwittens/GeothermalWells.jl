<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · GeothermalWells.jl</title><meta name="title" content="Home · GeothermalWells.jl"/><meta property="og:title" content="Home · GeothermalWells.jl"/><meta property="twitter:title" content="Home · GeothermalWells.jl"/><meta name="description" content="Documentation for GeothermalWells.jl."/><meta property="og:description" content="Documentation for GeothermalWells.jl."/><meta property="twitter:description" content="Documentation for GeothermalWells.jl."/><meta property="og:url" content="https://cwittens.github.io/GeothermalWells.jl/"/><meta property="twitter:url" content="https://cwittens.github.io/GeothermalWells.jl/"/><link rel="canonical" href="https://cwittens.github.io/GeothermalWells.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>GeothermalWells.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cwittens/GeothermalWells.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cwittens/GeothermalWells.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="GeothermalWells"><a class="docs-heading-anchor" href="#GeothermalWells">GeothermalWells</a><a id="GeothermalWells-1"></a><a class="docs-heading-anchor-permalink" href="#GeothermalWells" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/cwittens/GeothermalWells.jl">GeothermalWells</a>.</p><ul><li><a href="#GeothermalWells.AbstractBorehole"><code>GeothermalWells.AbstractBorehole</code></a></li><li><a href="#GeothermalWells.AbstractInletModel"><code>GeothermalWells.AbstractInletModel</code></a></li><li><a href="#GeothermalWells.AbstractMaterialProperties"><code>GeothermalWells.AbstractMaterialProperties</code></a></li><li><a href="#GeothermalWells.Borehole"><code>GeothermalWells.Borehole</code></a></li><li><a href="#GeothermalWells.ConstantInlet"><code>GeothermalWells.ConstantInlet</code></a></li><li><a href="#GeothermalWells.CustomInlet"><code>GeothermalWells.CustomInlet</code></a></li><li><a href="#GeothermalWells.HeatExchangerInlet"><code>GeothermalWells.HeatExchangerInlet</code></a></li><li><a href="#GeothermalWells.HomogenousMaterialProperties"><code>GeothermalWells.HomogenousMaterialProperties</code></a></li><li><a href="#GeothermalWells.StratifiedMaterialProperties"><code>GeothermalWells.StratifiedMaterialProperties</code></a></li><li><a href="#GeothermalWells.ADI_and_ADV_callback!-Tuple{Any}"><code>GeothermalWells.ADI_and_ADV_callback!</code></a></li><li><a href="#GeothermalWells.advection!-NTuple{5, Any}"><code>GeothermalWells.advection!</code></a></li><li><a href="#GeothermalWells.compute_domain-Tuple{Any}"><code>GeothermalWells.compute_domain</code></a></li><li><a href="#GeothermalWells.create_adaptive_grid_1d-Tuple{}"><code>GeothermalWells.create_adaptive_grid_1d</code></a></li><li><a href="#GeothermalWells.create_advection_index_lists-NTuple{5, Any}"><code>GeothermalWells.create_advection_index_lists</code></a></li><li><a href="#GeothermalWells.create_cache-Tuple{}"><code>GeothermalWells.create_cache</code></a></li><li><a href="#GeothermalWells.create_uniform_gridz_with_borehole_depths-Tuple{}"><code>GeothermalWells.create_uniform_gridz_with_borehole_depths</code></a></li><li><a href="#GeothermalWells.data_brown_single_well_b-Tuple{}"><code>GeothermalWells.data_brown_single_well_b</code></a></li><li><a href="#GeothermalWells.data_brown_single_well_c-Tuple{Any}"><code>GeothermalWells.data_brown_single_well_c</code></a></li><li><a href="#GeothermalWells.data_dir-Tuple{}"><code>GeothermalWells.data_dir</code></a></li><li><a href="#GeothermalWells.data_hu-Tuple{Int64}"><code>GeothermalWells.data_hu</code></a></li><li><a href="#GeothermalWells.data_li-Tuple{Any}"><code>GeothermalWells.data_li</code></a></li><li><a href="#GeothermalWells.eigen_estimator-Tuple{Any}"><code>GeothermalWells.eigen_estimator</code></a></li><li><a href="#GeothermalWells.eigen_estimator_get_dmax-Union{Tuple{StratifiedMaterialProperties{N}}, Tuple{N}} where N"><code>GeothermalWells.eigen_estimator_get_dmax</code></a></li><li><a href="#GeothermalWells.eigen_estimator_pre_calculation-Tuple{Any, Any}"><code>GeothermalWells.eigen_estimator_pre_calculation</code></a></li><li><a href="#GeothermalWells.examples_dir-Tuple{}"><code>GeothermalWells.examples_dir</code></a></li><li><a href="#GeothermalWells.get_callback-Tuple{}"><code>GeothermalWells.get_callback</code></a></li><li><a href="#GeothermalWells.get_rock_thermal_conductivity_by_depth-Union{Tuple{N}, Tuple{Any, StratifiedMaterialProperties{N}}} where N"><code>GeothermalWells.get_rock_thermal_conductivity_by_depth</code></a></li><li><a href="#GeothermalWells.get_rock_volumetric_heat_capacity_by_depth-Union{Tuple{N}, Tuple{Any, StratifiedMaterialProperties{N}}} where N"><code>GeothermalWells.get_rock_volumetric_heat_capacity_by_depth</code></a></li><li><a href="#GeothermalWells.get_thermal_conductivity-NTuple{5, Any}"><code>GeothermalWells.get_thermal_conductivity</code></a></li><li><a href="#GeothermalWells.get_volumetric_heat_capacity-NTuple{5, Any}"><code>GeothermalWells.get_volumetric_heat_capacity</code></a></li><li><a href="#GeothermalWells.initial_condition_thermal_gradient-NTuple{5, Any}"><code>GeothermalWells.initial_condition_thermal_gradient</code></a></li><li><a href="#GeothermalWells.pkg_dir-Tuple{}"><code>GeothermalWells.pkg_dir</code></a></li><li><a href="#GeothermalWells.rhs_diffusion_z!-NTuple{4, Any}"><code>GeothermalWells.rhs_diffusion_z!</code></a></li><li><a href="#GeothermalWells.save_and_print_callback-Tuple{Any}"><code>GeothermalWells.save_and_print_callback</code></a></li></ul><article><details class="docstring" open="true"><summary id="GeothermalWells.AbstractBorehole"><a class="docstring-binding" href="#GeothermalWells.AbstractBorehole"><code>GeothermalWells.AbstractBorehole</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Abstract base type for borehole geometries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L6-L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.AbstractInletModel"><a class="docstring-binding" href="#GeothermalWells.AbstractInletModel"><code>GeothermalWells.AbstractInletModel</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Abstract base type for inlet temperature models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L280-L282">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.AbstractMaterialProperties"><a class="docstring-binding" href="#GeothermalWells.AbstractMaterialProperties"><code>GeothermalWells.AbstractMaterialProperties</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Abstract base type for material property models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L1-L3">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.Borehole"><a class="docstring-binding" href="#GeothermalWells.Borehole"><code>GeothermalWells.Borehole</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">Borehole{T}(xc, yc, h, r_inner, t_inner, r_outer, t_outer, r_backfill, ṁ, insulation_depth)</code></pre><p>U-shaped coaxial borehole heat exchanger geometry.</p><p>Fluid flows down the inner pipe, turns around at depth <code>h</code>, and returns up the outer annulus. Precomputes squared radii and fluid velocities for performance.</p><p><strong>Fields</strong></p><ul><li><code>xc, yc</code>: horizontal center coordinates [m]</li><li><code>h</code>: borehole depth [m]</li><li><code>r_inner</code>: inner pipe radius [m]</li><li><code>t_inner</code>: inner pipe wall thickness [m]</li><li><code>r_outer</code>: outer pipe inner radius [m]</li><li><code>t_outer</code>: outer pipe wall thickness [m]</li><li><code>r_backfill</code>: cement backfill outer radius [m]</li><li><code>ṁ</code>: mass flow rate [kg/s]</li><li><code>insulation_depth</code>: depth to which inner pipe is insulated [m]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L11-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.ConstantInlet"><a class="docstring-binding" href="#GeothermalWells.ConstantInlet"><code>GeothermalWells.ConstantInlet</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ConstantInlet{T}(T_const)</code></pre><p>Inlet model with constant temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L285-L289">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.CustomInlet"><a class="docstring-binding" href="#GeothermalWells.CustomInlet"><code>GeothermalWells.CustomInlet</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">CustomInlet{F}(func)</code></pre><p>Inlet model with custom function <code>func(bh_idx, T_outlet_values, t)</code>.</p><p>Allows arbitrary time-varying or borehole-specific inlet temperatures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L308-L314">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.HeatExchangerInlet"><a class="docstring-binding" href="#GeothermalWells.HeatExchangerInlet"><code>GeothermalWells.HeatExchangerInlet</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">HeatExchangerInlet{T}(ΔT)</code></pre><p>Inlet model applying temperature change <code>ΔT</code> [K] to outlet temperature.</p><p>Models a heat exchanger where inlet is <code>T_outlet - ΔT</code>. Typically computed as <code>ΔT = Q / (ṁ * c_water)</code> where <code>Q</code> [W] is heat extraction rate, <code>ṁ</code> [kg/s] is mass flow rate, and <code>c_water</code> [J/(kg·K)] is specific heat.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L295-L302">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.HomogenousMaterialProperties"><a class="docstring-binding" href="#GeothermalWells.HomogenousMaterialProperties"><code>GeothermalWells.HomogenousMaterialProperties</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">HomogenousMaterialProperties{T}</code></pre><p>Thermal properties with uniform rock properties (no stratification).</p><p>Simpler alternative to <a href="#GeothermalWells.StratifiedMaterialProperties"><code>StratifiedMaterialProperties</code></a> when rock is homogeneous.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L152-L158">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.StratifiedMaterialProperties"><a class="docstring-binding" href="#GeothermalWells.StratifiedMaterialProperties"><code>GeothermalWells.StratifiedMaterialProperties</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">StratifiedMaterialProperties{N,T}</code></pre><p>Thermal properties for stratified rock layers and borehole materials.</p><p>Supports <code>N</code> horizontal rock layers with varying properties by depth. Includes material properties for water, steel, insulation, and cement backfill.</p><p><strong>Fields</strong></p><ul><li><code>k_rock_layers</code>: thermal conductivities for each rock layer [W/(m·K)]</li><li><code>rho_c_rock_layers</code>: volumetric heat capacities for each layer [J/(m³·K)]</li><li><code>layer_depths</code>: depth boundaries for each layer [m]</li><li><code>k_water</code>, <code>rho_c_water</code>: water thermal properties</li><li><code>k_steel</code>, <code>rho_c_steel</code>: steel pipe thermal properties</li><li><code>k_insulating</code>, <code>rho_c_insulating</code>: insulation thermal properties</li><li><code>k_backfill</code>, <code>rho_c_backfill</code>: cement backfill thermal properties</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L64-L80">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.ADI_and_ADV_callback!-Tuple{Any}"><a class="docstring-binding" href="#GeothermalWells.ADI_and_ADV_callback!-Tuple{Any}"><code>GeothermalWells.ADI_and_ADV_callback!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">ADI_and_ADV_callback!(integrator)</code></pre><p>Alternating Direction Implicit (ADI) callback for horizontal (x,y) diffusion combined with advection.</p><p>This callback implements operator splitting for the horizontal diffusion using the ADI scheme, interleaved with semi-Lagrangian advection. Each full timestep <code>Δt</code> is split into  two half-steps with alternating implicit directions:</p><p><strong>First half-step (Δt/2):</strong></p><ol><li>Explicit y-diffusion: <code>temp = (I + Δt/2 · Aᵧ) · ϕ</code></li><li>Advection applied to <code>temp</code></li><li>Implicit x-solve: <code>(I - Δt/2 · Aₓ) · ϕ = temp</code></li></ol><p><strong>Second half-step (Δt/2):</strong></p><ol><li>Explicit x-diffusion: <code>temp = (I + Δt/2 · Aₓ) · ϕ</code></li><li>Advection applied to <code>temp</code></li><li>Implicit y-solve: <code>(I - Δt/2 · Aᵧ) · ϕ = temp</code></li></ol><p>The advection is placed after the explicit diffusion step and before the implicit Thomas solve.  Empirically, this is the only placement that avoids numerical instabilities. The suspected reason  is that advection introduces large thermal gradients, and applying it before an explicit Euler-like  step causes instability, whereas the subsequent implicit solve can handle these gradients stably.  However, the exact theoretical justification remains uncertain.</p><p>Vertical (z) diffusion is handled separately by the main ODE right-hand side (<code>rhs_diffusion_z!</code>)  because the ADI scheme is only unconditionally stable in 2D. However, since <code>Δz</code> is much larger  than the smallest <code>Δx</code> and <code>Δy</code> (due to the fine grid resolution needed near the borehole), an  explicit stabilized method (ROCK2) is sufficient for the z-direction without imposing  prohibitive time step restrictions.</p><p>The implicit x/y solves use the Thomas algorithm for the resulting tridiagonal systems.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/solver.jl#L399-L431">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.advection!-NTuple{5, Any}"><a class="docstring-binding" href="#GeothermalWells.advection!-NTuple{5, Any}"><code>GeothermalWells.advection!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">advection!(ϕ, dt, t, cache, boreholes)</code></pre><p>Apply advective heat transport in the borehole pipes using a semi-Lagrangian method.</p><p>The water flow itself is not simulated—instead, the fluid is assumed to move at prescribed  constant velocities: <code>v_inner</code> (downward in the inner pipe) and <code>v_outer</code> (upward in the  outer annulus). Only the temperature field is advected according to these fixed velocity profiles.</p><p>A semi-Lagrangian approach is used rather than standard explicit advection schemes because  the high fluid velocities would impose prohibitively small time steps under the CFL constraint.  The semi-Lagrangian method traces characteristic lines backward in time to find the departure  point, then interpolates the temperature there using linear interpolation between grid points. At the turnaround point at the bottom of the borehole (depth <code>h</code>), where water transitions  from the inner pipe to the outer annulus, perfect mixing of temperature is assumed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/solver.jl#L234-L249">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.compute_domain-Tuple{Any}"><a class="docstring-binding" href="#GeothermalWells.compute_domain-Tuple{Any}"><code>GeothermalWells.compute_domain</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute_domain(boreholes; buffer_x=100, buffer_y=100, buffer_z=200)</code></pre><p>Compute simulation domain bounds from borehole positions.</p><p>Returns <code>(xmin, xmax, ymin, ymax, zmin, zmax)</code> encompassing all boreholes with specified buffers [m].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/grids.jl#L1-L7">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.create_adaptive_grid_1d-Tuple{}"><a class="docstring-binding" href="#GeothermalWells.create_adaptive_grid_1d-Tuple{}"><code>GeothermalWells.create_adaptive_grid_1d</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">create_adaptive_grid_1d(; xmin, xmax, dx_fine, growth_factor, dx_max, boreholes, backend, Float_used, direction)</code></pre><p>Generate a non-uniform 1D grid with refined spacing around one or multiple boreholes.</p><p>Creates a 1D grid along the specified direction with fine resolution near boreholes and geometrically increasing spacing away from them, up to a maximum cell size. Works for both single borehole and multi-borehole configurations.</p><p><strong>Arguments</strong></p><ul><li><code>xmin</code>, <code>xmax</code>: Domain boundaries [m]</li><li><code>dx_fine</code>: Fine grid spacing near boreholes [m]</li><li><code>growth_factor</code>: Geometric growth rate for coarsening (e.g., 1.3)</li><li><code>dx_max</code>: Maximum grid spacing [m]</li><li><code>boreholes</code>: Single borehole or collection of borehole objects with positions and radii</li><li><code>backend</code>: Computation backend (CPU/GPU) for array adaptation</li><li><code>Float_used</code>: Floating point type for grid values</li><li><code>direction</code>: Grid direction, either <code>:x</code> or <code>:y</code></li></ul><p><strong>Grid generation strategy</strong></p><p>For single or multiple boreholes:</p><ol><li>Creates fine uniform grids around each borehole (spacing ≈ <code>dx_fine</code>)</li><li>Extends from domain boundaries toward boreholes with geometric growth</li><li>For multiple boreholes: fills gaps between boreholes symmetrically with progressive coarsening</li><li>Ensures all grid points are unique and sorted</li></ol><p><strong>Returns</strong></p><p>Backend-adapted 1D grid array of the specified floating point type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/grids.jl#L51-L79">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.create_advection_index_lists-NTuple{5, Any}"><a class="docstring-binding" href="#GeothermalWells.create_advection_index_lists-NTuple{5, Any}"><code>GeothermalWells.create_advection_index_lists</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">create_advection_index_lists(backend, gridx, gridy, gridz, boreholes)</code></pre><p>Create index lists for advection in inner and outer pipes.</p><p>Returns tuple with index lists for efficient advection kernel dispatch.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/cache.jl#L2-L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.create_cache-Tuple{}"><a class="docstring-binding" href="#GeothermalWells.create_cache-Tuple{}"><code>GeothermalWells.create_cache</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">create_cache(; backend, gridx, gridy, gridz, materials, boreholes, inlet_model)</code></pre><p>Create simulation cache with precomputed data and temporary arrays.</p><p>Returns named tuple containing grids, materials, index lists, outlet temperature arrays, eigenvalue estimates, and precomputed <code>Val</code> types for kernel dispatch.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/cache.jl#L47-L54">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.create_uniform_gridz_with_borehole_depths-Tuple{}"><a class="docstring-binding" href="#GeothermalWells.create_uniform_gridz_with_borehole_depths-Tuple{}"><code>GeothermalWells.create_uniform_gridz_with_borehole_depths</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">create_uniform_gridz_with_borehole_depths(; zmin, zmax, dz, boreholes, backend)</code></pre><p>Create vertical grid including all borehole depths.</p><p>Ensures each borehole depth <code>h</code> is a grid point for accurate advection interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/grids.jl#L22-L28">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.data_brown_single_well_b-Tuple{}"><a class="docstring-binding" href="#GeothermalWells.data_brown_single_well_b-Tuple{}"><code>GeothermalWells.data_brown_single_well_b</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">data_brown_single_well_b() -&gt; (z_beier, T_beier), (z_brown, T_brown)</code></pre><p>Load Brown et al. single well validation data (Figure 4b).</p><p>From: Investigating scalability of deep borehole heat exchangers (doi:10.1016/j.renene.2021.01.036) Returns depth [m] and temperature [°C] profiles for Beier and Brown models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/util.jl#L22-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.data_brown_single_well_c-Tuple{Any}"><a class="docstring-binding" href="#GeothermalWells.data_brown_single_well_c-Tuple{Any}"><code>GeothermalWells.data_brown_single_well_c</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">data_brown_single_well_c(i) -&gt; x_data, T_data</code></pre><p>Load Brown et al. single well validation data (Figure 4c).</p><p><code>i=1,2,3</code> for 300m, 600m, 920m depths respectively. From: doi:10.1016/j.renene.2021.01.036</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/util.jl#L52-L59">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.data_dir-Tuple{}"><a class="docstring-binding" href="#GeothermalWells.data_dir-Tuple{}"><code>GeothermalWells.data_dir</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">data_dir()</code></pre><p>Return path to package data directory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/util.jl#L8-L12">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.data_hu-Tuple{Int64}"><a class="docstring-binding" href="#GeothermalWells.data_hu-Tuple{Int64}"><code>GeothermalWells.data_hu</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">data_hu(years::Int) -&gt; depth, temperature</code></pre><p>Load Hu et al. validation data for specified simulation years (Figure 7).</p><p>From: Numerical modeling of a coaxial borehole heat exchanger (doi:10.1016/j.renene.2019.09.141) Returns depth [m] and temperature [°C].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/util.jl#L78-L85">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.data_li-Tuple{Any}"><a class="docstring-binding" href="#GeothermalWells.data_li-Tuple{Any}"><code>GeothermalWells.data_li</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">data_li(i) -&gt; x_data, T_data</code></pre><p>Load Li et al. validation data (Figure 5).</p><p><code>i=1,2,3,4</code> for 500m, 1000m, 1500m, 2000m depths respectively. From: Heat extraction model and characteristics of coaxial deep borehole heat exchanger</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/util.jl#L98-L105">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.eigen_estimator-Tuple{Any}"><a class="docstring-binding" href="#GeothermalWells.eigen_estimator-Tuple{Any}"><code>GeothermalWells.eigen_estimator</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">eigen_estimator(integrator)</code></pre><p>Eigenvalue estimator function for adaptive time stepping in ROCK methods.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/solver.jl#L490-L494">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.eigen_estimator_get_dmax-Union{Tuple{StratifiedMaterialProperties{N}}, Tuple{N}} where N"><a class="docstring-binding" href="#GeothermalWells.eigen_estimator_get_dmax-Union{Tuple{StratifiedMaterialProperties{N}}, Tuple{N}} where N"><code>GeothermalWells.eigen_estimator_get_dmax</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">eigen_estimator_get_dmax(materials) -&gt; d_max</code></pre><p>Compute maximum thermal diffusivity [m²/s] across all materials.</p><p>Used for eigenvalue estimation in time stepping stability analysis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L127-L133">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.eigen_estimator_pre_calculation-Tuple{Any, Any}"><a class="docstring-binding" href="#GeothermalWells.eigen_estimator_pre_calculation-Tuple{Any, Any}"><code>GeothermalWells.eigen_estimator_pre_calculation</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">eigen_estimator_pre_calculation(gridz, materials) -&gt; λ_max</code></pre><p>Pre-calculate eigenvalue estimate [s⁻¹] for ROCK2/ROCK4 time stepping.</p><p>Estimates maximum eigenvalue based on finest grid spacing and maximum diffusivity. Returns <code>λ_max ≈ 8 * d_max / Δ_min²</code> where conservative factor of 8 accounts for 3D diffusion operator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/solver.jl#L466-L473">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.examples_dir-Tuple{}"><a class="docstring-binding" href="#GeothermalWells.examples_dir-Tuple{}"><code>GeothermalWells.examples_dir</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">examples_dir()</code></pre><p>Return path to package examples directory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/util.jl#L1-L5">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.get_callback-Tuple{}"><a class="docstring-binding" href="#GeothermalWells.get_callback-Tuple{}"><code>GeothermalWells.get_callback</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_callback(; saveat, print_every_n=1000, write_to_jld=false, data_folder_dir=&quot;&quot;)</code></pre><p>Create combined callback set for simulation.</p><p>Includes ADI+advection callback, progress printing, and solution saving. Returns <code>(callback, saved_values)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/cache.jl#L184-L191">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.get_rock_thermal_conductivity_by_depth-Union{Tuple{N}, Tuple{Any, StratifiedMaterialProperties{N}}} where N"><a class="docstring-binding" href="#GeothermalWells.get_rock_thermal_conductivity_by_depth-Union{Tuple{N}, Tuple{Any, StratifiedMaterialProperties{N}}} where N"><code>GeothermalWells.get_rock_thermal_conductivity_by_depth</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_rock_thermal_conductivity_by_depth(z, materials::StratifiedMaterialProperties) -&gt; k</code></pre><p>Return rock thermal conductivity [W/(m·K)] at depth <code>z</code> based on stratified layers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L97-L101">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.get_rock_volumetric_heat_capacity_by_depth-Union{Tuple{N}, Tuple{Any, StratifiedMaterialProperties{N}}} where N"><a class="docstring-binding" href="#GeothermalWells.get_rock_volumetric_heat_capacity_by_depth-Union{Tuple{N}, Tuple{Any, StratifiedMaterialProperties{N}}} where N"><code>GeothermalWells.get_rock_volumetric_heat_capacity_by_depth</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_rock_volumetric_heat_capacity_by_depth(z, materials::StratifiedMaterialProperties) -&gt; ρc</code></pre><p>Return rock volumetric heat capacity [J/(m³·K)] at depth <code>z</code> based on stratified layers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L112-L116">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.get_thermal_conductivity-NTuple{5, Any}"><a class="docstring-binding" href="#GeothermalWells.get_thermal_conductivity-NTuple{5, Any}"><code>GeothermalWells.get_thermal_conductivity</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_thermal_conductivity(x, y, z, boreholes, materials) -&gt; k</code></pre><p>Return thermal conductivity [W/(m·K)] at point <code>(x, y, z)</code>.</p><p>Determines the appropriate material (rock, water, steel, insulation, or backfill) based on position relative to borehole geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L191-L198">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.get_volumetric_heat_capacity-NTuple{5, Any}"><a class="docstring-binding" href="#GeothermalWells.get_volumetric_heat_capacity-NTuple{5, Any}"><code>GeothermalWells.get_volumetric_heat_capacity</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">get_volumetric_heat_capacity(x, y, z, boreholes, materials) -&gt; ρc</code></pre><p>Return volumetric heat capacity [J/(m³·K)] at point <code>(x, y, z)</code>.</p><p>Determines the appropriate material based on position relative to borehole geometry.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L236-L242">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.initial_condition_thermal_gradient-NTuple{5, Any}"><a class="docstring-binding" href="#GeothermalWells.initial_condition_thermal_gradient-NTuple{5, Any}"><code>GeothermalWells.initial_condition_thermal_gradient</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_thermal_gradient(backend, Float_used, gridx, gridy, gridz; T_surface, gradient)</code></pre><p>Create initial temperature field with linear thermal gradient.</p><p>Returns 3D array with <code>T(z) = T_surface + gradient * z</code> where <code>T_surface</code> is surface temperature [°C] and <code>gradient</code> is thermal gradient [K/m or °C/m].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/physics.jl#L325-L332">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.pkg_dir-Tuple{}"><a class="docstring-binding" href="#GeothermalWells.pkg_dir-Tuple{}"><code>GeothermalWells.pkg_dir</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">pkg_dir()</code></pre><p>Return package root directory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/util.jl#L15-L19">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.rhs_diffusion_z!-NTuple{4, Any}"><a class="docstring-binding" href="#GeothermalWells.rhs_diffusion_z!-NTuple{4, Any}"><code>GeothermalWells.rhs_diffusion_z!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">rhs_diffusion_z!(dϕ, ϕ, cache, t)</code></pre><p>Compute right-hand side for vertical (z-direction) heat diffusion.</p><p>This is the RHS function passed to OrdinaryDiffEq.jl and is integrated using an explicit  stabilized ROCK method. Vertical diffusion is treated separately from horizontal (x,y) diffusion  because the ADI scheme is only unconditionally stable in 2D. Since <code>Δz</code> is much larger than the  smallest <code>Δx</code> and <code>Δy</code> (due to the fine grid resolution needed near the borehole), the explicit  ROCK method is sufficient for the z-direction without imposing prohibitive time step restrictions.</p><p>Horizontal diffusion via the ADI method and advection are handled separately using the callback  functionality (<code>ADI_and_ADV_callback!</code>)—a workaround to implement operator splitting within the  OrdinaryDiffEq.jl framework.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/solver.jl#L8-L22">source</a></section></details></article><article><details class="docstring" open="true"><summary id="GeothermalWells.save_and_print_callback-Tuple{Any}"><a class="docstring-binding" href="#GeothermalWells.save_and_print_callback-Tuple{Any}"><code>GeothermalWells.save_and_print_callback</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">save_and_print_callback(saveat; print_every_n=1000, write_to_jld=false, data_folder_dir=&quot;&quot;)</code></pre><p>Create callbacks for printing progress and saving solution snapshots.</p><p>Returns <code>(save_cb, print_cb, saved_values)</code> for use with ODE solver. Optionally writes checkpoints to JLD2 files if <code>write_to_jld=true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cwittens/GeothermalWells.jl/blob/0997b2e2567c07cb67aa62d8414560f82b8f2591/src/cache.jl#L124-L131">source</a></section></details></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 24 January 2026 21:16">Saturday 24 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
