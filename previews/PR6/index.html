<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · GeothermalWells.jl</title><meta name="title" content="Home · GeothermalWells.jl"/><meta property="og:title" content="Home · GeothermalWells.jl"/><meta property="twitter:title" content="Home · GeothermalWells.jl"/><meta name="description" content="Documentation for GeothermalWells.jl."/><meta property="og:description" content="Documentation for GeothermalWells.jl."/><meta property="twitter:description" content="Documentation for GeothermalWells.jl."/><meta property="og:url" content="https://cwittens.github.io/GeothermalWells.jl/"/><meta property="twitter:url" content="https://cwittens.github.io/GeothermalWells.jl/"/><link rel="canonical" href="https://cwittens.github.io/GeothermalWells.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.svg" alt="GeothermalWells.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>GeothermalWells.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Features"><span>Features</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Quick-Example"><span>Quick Example</span></a></li><li><a class="tocitem" href="#Examples-and-Reproducibility"><span>Examples and Reproducibility</span></a></li><li><a class="tocitem" href="#Referencing"><span>Referencing</span></a></li><li><a class="tocitem" href="#Authors"><span>Authors</span></a></li><li><a class="tocitem" href="#License"><span>License</span></a></li></ul></li><li><a class="tocitem" href="methodology/">Methodology</a></li><li><a class="tocitem" href="getting_started/">Getting Started</a></li><li><a class="tocitem" href="changelog/">Changelog</a></li><li><a class="tocitem" href="reference/">API Reference</a></li><li><a class="tocitem" href="license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cwittens/GeothermalWells.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cwittens/GeothermalWells.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="GeothermalWells.jl"><a class="docs-heading-anchor" href="#GeothermalWells.jl">GeothermalWells.jl</a><a id="GeothermalWells.jl-1"></a><a class="docs-heading-anchor-permalink" href="#GeothermalWells.jl" title="Permalink"></a></h1><p align="center">
  <img height="200px" alt="logo" src="assets/geothermalwells_banner.svg">
</p><p><a href="https://cwittens.github.io/GeothermalWells.jl/stable/"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="Docs-stable"/></a> <a href="https://cwittens.github.io/GeothermalWells.jl/dev/"><img src="https://img.shields.io/badge/docs-dev-blue.svg" alt="Docs-dev"/></a> <a href="https://julialang.org"><img src="https://img.shields.io/badge/Julia-1.12+-purple.svg" alt="Julia"/></a> <a href="https://github.com/cwittens/GeothermalWells.jl/actions/workflows/CI.yml?query=branch%3Amain"><img src="https://github.com/cwittens/GeothermalWells.jl/actions/workflows/CI.yml/badge.svg?branch=main" alt="Build Status"/></a> <a href="https://codecov.io/gh/cwittens/GeothermalWells.jl"><img src="https://codecov.io/gh/cwittens/GeothermalWells.jl/branch/main/graph/badge.svg" alt="Coverage"/></a> <a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-success.svg" alt="License: MIT"/></a></p><p><strong>GeothermalWells.jl</strong> is a Julia package for simulating deep borehole heat exchangers (DBHEs), supporting both single wells and well arrays. The package is designed to be easy to use, enabling rapid prototyping and well design exploration, while providing GPU-accelerated performance for long-term simulations.</p><div class="admonition is-info" id="Under-Development-b7f60ced2e102e73"><header class="admonition-header">Under Development<a class="admonition-anchor" href="#Under-Development-b7f60ced2e102e73" title="Permalink"></a></header><div class="admonition-body"><p>This package is currently under active development and there may be breaking changes.</p></div></div><h2 id="Features"><a class="docs-heading-anchor" href="#Features">Features</a><a id="Features-1"></a><a class="docs-heading-anchor-permalink" href="#Features" title="Permalink"></a></h2><ul><li>Full 3D simulation of coaxial deep borehole heat exchangers</li><li>Support for single wells and multi-well arrays</li><li>GPU acceleration via <a href="https://github.com/JuliaGPU/KernelAbstractions.jl">KernelAbstractions.jl</a> (CUDA, AMD ROCm)</li><li>Adaptive grid generation with fine resolution near boreholes</li><li>Integration with <a href="https://github.com/SciML/OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a> solvers</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>GeothermalWells.jl works with Julia v1.12 and newer. Install it from the Julia REPL:</p><pre><code class="language-julia hljs">julia&gt; using Pkg
julia&gt; Pkg.add(&quot;GeothermalWells&quot;)</code></pre><p>For GPU support, also install the appropriate backend:</p><pre><code class="language-julia hljs">julia&gt; Pkg.add(&quot;CUDA&quot;)        # for NVIDIA GPUs
julia&gt; Pkg.add(&quot;AMDGPU&quot;)      # for AMD GPUs</code></pre><h2 id="Quick-Example"><a class="docs-heading-anchor" href="#Quick-Example">Quick Example</a><a id="Quick-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">using GeothermalWells
using OrdinaryDiffEqStabilizedRK: ODEProblem, solve, ROCK2
using KernelAbstractions: CPU

# Define material properties
materials = HomogenousMaterialProperties{Float64}(
    2.88,    # k_rock [W/(m·K)]
    2.17e6,  # rho_c_rock [J/(m³·K)]
    0.6,     # k_water [W/(m·K)]
    4.18e6,  # rho_c_water [J/(m³·K)]
    44.5,    # k_steel [W/(m·K)]
    3.73e6,  # rho_c_steel [J/(m³·K)]
    0.26,    # k_insulating [W/(m·K)]
    1.96e6,  # rho_c_insulating [J/(m³·K)]
    1.0,     # k_backfill [W/(m·K)]
    1.0      # rho_c_backfill [J/(m³·K)]
)

# Define borehole geometry
borehole = Borehole{Float64}(
    0.0, 0.0,    # center position (x, y) [m]
    2000.0,      # depth [m]
    0.0381,      # inner pipe radius [m]
    0.01,        # inner pipe thickness [m]
    0.0889,      # outer pipe radius [m]
    0.01,        # outer pipe thickness [m]
    0.0989,      # backfill radius [m]
    10.0,        # mass flow rate [kg/s]
    500.0        # insulation depth [m]
)

# Create grids
gridx = create_adaptive_grid_1d(xmin=-100.0, xmax=100.0, dx_fine=0.0025,
    growth_factor=1.3, dx_max=10.0, boreholes=(borehole,),
    backend=CPU(), Float_used=Float64, direction=:x)
gridy = create_adaptive_grid_1d(xmin=-100.0, xmax=100.0, dx_fine=0.0025,
    growth_factor=1.3, dx_max=10.0, boreholes=(borehole,),
    backend=CPU(), Float_used=Float64, direction=:y)
gridz = create_uniform_gridz_with_borehole_depths(zmin=0.0, zmax=2200.0,
    dz=100.0, boreholes=(borehole,), backend=CPU())

# Initial temperature with geothermal gradient
T0 = initial_condition_thermal_gradient(CPU(), Float64, gridx, gridy, gridz;
    T_surface=10.0, gradient=0.03)

# Create cache and solve
cache = create_cache(backend=CPU(), gridx=gridx, gridy=gridy, gridz=gridz,
    materials=materials, boreholes=(borehole,),
    inlet_model=ConstantInlet{Float64}(20.0))

callback, saved_values = get_simulation_callback(saveat=[0.0, 3600.0])

prob = ODEProblem(rhs_diffusion_z!, T0, (0.0, 3600.0), cache)
solve(prob, ROCK2(eigen_est=eigen_estimator), dt=60.0, callback=callback, adaptive=false)</code></pre><p>See the <a href="getting_started/#getting-started">Getting Started</a> guide for a complete walkthrough.</p><h2 id="Examples-and-Reproducibility"><a class="docs-heading-anchor" href="#Examples-and-Reproducibility">Examples and Reproducibility</a><a id="Examples-and-Reproducibility-1"></a><a class="docs-heading-anchor-permalink" href="#Examples-and-Reproducibility" title="Permalink"></a></h2><p>For more comprehensive examples, including validation against published literature, see the <a href="https://github.com/cwittens/2026_DBHEs_Arrays">reproducibility repository</a>. This repository contains:</p><ul><li>Reproduction of results from Li et al. (2021), Hu et al. (2020), Brown et al. (2023)</li><li>Convergence studies</li><li>Well array simulations</li></ul><h2 id="Referencing"><a class="docs-heading-anchor" href="#Referencing">Referencing</a><a id="Referencing-1"></a><a class="docs-heading-anchor-permalink" href="#Referencing" title="Permalink"></a></h2><p>If you use <a href="https://github.com/cwittens/GeothermalWells.jl">GeothermalWells.jl</a> in your research, please cite it:</p><pre><code class="language-bibtex hljs">@software{wittenstein2026geothermalwells,
  title={{GeothermalWells.jl}: {GPU}-accelerated simulation of deep borehole heat exchanger (DBHE) arrays},
  author={Wittenstein, Collin},
  year={2026},
  howpublished={\url{https://github.com/cwittens/GeothermalWells.jl}},
  doi = {10.5281/zenodo.18405325}
}</code></pre><h2 id="Authors"><a class="docs-heading-anchor" href="#Authors">Authors</a><a id="Authors-1"></a><a class="docs-heading-anchor-permalink" href="#Authors" title="Permalink"></a></h2><ul><li><a href="https://cwittens.github.io/">Collin Wittenstein</a> (Massachusetts Institute of Technology &amp; Johannes Gutenberg University Mainz)</li></ul><h2 id="License"><a class="docs-heading-anchor" href="#License">License</a><a id="License-1"></a><a class="docs-heading-anchor-permalink" href="#License" title="Permalink"></a></h2><p>GeothermalWells.jl is licensed under the MIT license (see <a href="license/#license-page">License</a>).</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="methodology/">Methodology »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 2 February 2026 15:25">Monday 2 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
